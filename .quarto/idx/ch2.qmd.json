{"title":"Solution to Chapter 2 Exercises","markdown":{"headingText":"Solution to Chapter 2 Exercises","containsRefs":false,"markdown":"\n```{r}\n#| message: false\n#| warning: false\nlibrary(fpp3)\n```\n\n\n## Exercise 1 {.unnumbered}\n\nExplore the following four time series: `Bricks` from `aus_production`, `Lynx` from `pelt`, `Close` from `gafa_stock`, `Demand` from `vic_elec`.\n\n    a. What is the time interval of each series?\n    b. Use autoplot() to produce a time plot of each series. For the last plot, modify the axis labels and title.\n    \n    \n### (a) {.unnumbered}\n\n```{r}\ntsibble::interval(aus_production)\ntsibble::interval(pelt)\n```\n\n\n```{r}\ngafa_stock %>% select(Close)\n```\n\n```{r}\ntsibble::interval(gafa_stock)\n```\n\n\n`gafa_stock` data has irregular time interval.\n\n```{r}\ntsibble::interval(vic_elec)\n```\n\n`vic_elec` data has a time interval of 30 mins.\n\n\n### (b) {.unnumbered}\n\n```{r}\naus_production %>% autoplot(Bricks)\npelt %>% autoplot(Lynx)\ngafa_stock %>% autoplot(Close) + labs(x = NULL)\nvic_elec %>% \n  autoplot(Demand) +\n  labs(title = \"Time series of Demand from vic_elec\", x = NULL)\n```\n\n\n## Exercise 2 \n\nUse `filter()` to find what days corresponded to the peak closing price for each of the four stocks in gafa_stock.\n\n```{r}\ngafa_stock %>% \n  group_by(Symbol) %>%\n  filter(Close == max(Close)) %>% \n  select(Symbol, Date, Close) %>% ungroup()\n```\n\n\n## Exercise 3\n\nDownload the file `tute1.csv` from the [book website](https://bit.ly/fpptute1), open it in Excel (or some other spreadsheet application), and review its contents. You should find four columns of information. Columns B through D each contain a quarterly series, labelled Sales, AdBudget and GDP. Sales contains the quarterly sales for a small company over the period 1981-2005. AdBudget is the advertising budget and GDP is the gross domestic product. All series have been adjusted for inflation.\n\n    (a) Read the data and create time series\n    (b) Construct ts plot for each series\n\n```{r}\n#| message: false\ntute1 <- readr::read_csv(here::here(\"data/tute1.csv\"))\nhead(tute1)\n```\n\n```{r}\ntute1 %>% \n  mutate(Quarter = yearquarter(Quarter)) %>% \n  as_tsibble(index = Quarter) -> ts_tute\n\nts_tute\n```\n\n\n```{r}\nts_tute %>% \n  pivot_longer(-Quarter) %>% autoplot(value)\n```\n\n```{r}\nts_tute %>% \n  pivot_longer(-Quarter) %>% \n  ggplot(aes(x = Quarter, y = value, color = name)) +\n  geom_line()\n```\n\n```{r}\nts_tute %>% \n  pivot_longer(-Quarter) %>% \n  ggplot(aes(x = Quarter, y = value, color = name)) +\n  geom_line() +\n  facet_grid(name ~ ., scales = \"free_y\")\n```\n\n## Exercise 4\n\nThe `USgas` package contains data on the demand for natural gas in the US.\n\n(a) Create a tsibble from us_total with year as the index and state as the key.\n(b) Plot the annual natural gas consumption by state for the New England area (comprising the states of Maine, Vermont, New Hampshire, Massachusetts, Connecticut and Rhode Island).\n\n```{r}\ndata(us_total, package = \"USgas\")\n\nhead(us_total)\n```\n\n```{r}\nus_total %>% \n  as_tsibble(index = year, key = state) -> ts_us_total\n\nts_us_total\n```\n\n```{r}\nts_us_total %>% \n  filter(state %in% c(\"Maine\", \"Vermont\", \"New Hampshire\", \"Massachusetts\", \"Connecticut\",\n                      \"Rhode Island\")) %>% \n  autoplot(y) +\n  scale_y_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale()))\n```\n\n## Exercise 5\n\n(a) Download `tourism.xlsx` from the [book website](https://bit.ly/fpptourism) and read it into R using `readxl::read_excel()`.\n(b) Create a `tsibble` which is identical to the tourism tsibble from the tsibble package.\n(c) Find what combination of Region and Purpose had the maximum number of overnight trips on average.\n(d) Create a new `tsibble` which combines the Purposes and Regions, and just has total trips by State.\n\n```{r}\ntourism_xl <- readxl::read_excel(\"data/tourism.xlsx\")\nhead(tourism_xl)\n```\n\n```{r}\ntourism\n```\n\n\n\n```{r}\ntourism_xl %>% \n  mutate(Quarter = yearquarter(Quarter)) %>% \n  as_tsibble(index = Quarter, key = c(Region, State, Purpose)) -> tourism_ts\n\ntourism_ts\n```\n\n```{r}\ntourism_ts %>% \n  group_by(Region, Purpose) %>% \n  summarise(trips = sum(Trips), .groups = \"drop\") %>%\n  slice_max(trips, n = 1)\n```\n\n```{r}\ntourism_ts %>% \n  group_by(State) %>% \n  summarise(trips = sum(Trips), .groups = \"drop\") -> trips_by_state\n\ntrips_by_state\n```\n\n\n## Exercise 6\n\nThe `aus_arrivals` data set comprises quarterly international arrivals to Australia from Japan, New Zealand, UK and the US.\n\n(a) Use `autoplot()`, `gg_season()` and `gg_subseries()` to compare the differences between the arrivals from these four countries.\n(b) Can you identify any unusual observations?\n\n```{r}\naus_arrivals\n```\n\n```{r}\naus_arrivals %>% \n  autoplot(Arrivals) +\n  scale_y_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale()))\n```\n\n```{r}\naus_arrivals %>% \n  gg_season(Arrivals) +\n  scale_y_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale()))\n```\n\n```{r}\naus_arrivals %>% gg_subseries(Arrivals)\n```\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"ch2.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}