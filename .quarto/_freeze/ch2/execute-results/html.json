{
  "hash": "51e8c1dc8318ee890d0a56fbb3a1133c",
  "result": {
    "engine": "knitr",
    "markdown": "# Solution to Chapter 2 Exercises\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fpp3)\n```\n:::\n\n\n\n## Exercise 1 {.unnumbered}\n\nExplore the following four time series: `Bricks` from `aus_production`, `Lynx` from `pelt`, `Close` from `gafa_stock`, `Demand` from `vic_elec`.\n\n    a. What is the time interval of each series?\n    b. Use autoplot() to produce a time plot of each series. For the last plot, modify the axis labels and title.\n    \n    \n### (a) {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble::interval(aus_production)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<interval[1]>\n[1] 1Q\n```\n\n\n:::\n\n```{.r .cell-code}\ntsibble::interval(pelt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<interval[1]>\n[1] 1Y\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngafa_stock %>% select(Close)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 5,032 x 3 [!]\n# Key:       Symbol [4]\n   Close Date       Symbol\n   <dbl> <date>     <chr> \n 1  79.0 2014-01-02 AAPL  \n 2  77.3 2014-01-03 AAPL  \n 3  77.7 2014-01-06 AAPL  \n 4  77.1 2014-01-07 AAPL  \n 5  77.6 2014-01-08 AAPL  \n 6  76.6 2014-01-09 AAPL  \n 7  76.1 2014-01-10 AAPL  \n 8  76.5 2014-01-13 AAPL  \n 9  78.1 2014-01-14 AAPL  \n10  79.6 2014-01-15 AAPL  \n# ℹ 5,022 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble::interval(gafa_stock)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<interval[1]>\n[1] !\n```\n\n\n:::\n:::\n\n\n\n`gafa_stock` data has irregular time interval.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble::interval(vic_elec)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<interval[1]>\n[1] 30m\n```\n\n\n:::\n:::\n\n\n`vic_elec` data has a time interval of 30 mins.\n\n\n### (b) {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\naus_production %>% autoplot(Bricks)\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\npelt %>% autoplot(Lynx)\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\ngafa_stock %>% autoplot(Close) + labs(x = NULL)\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\nvic_elec %>% \n  autoplot(Demand) +\n  labs(title = \"Time series of Demand from vic_elec\", x = NULL)\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n:::\n\n\n\n## Exercise 2 \n\nUse `filter()` to find what days corresponded to the peak closing price for each of the four stocks in gafa_stock.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngafa_stock %>% \n  group_by(Symbol) %>%\n  filter(Close == max(Close)) %>% \n  select(Symbol, Date, Close) %>% ungroup()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 4 x 3 [!]\n# Key:       Symbol [4]\n  Symbol Date       Close\n  <chr>  <date>     <dbl>\n1 AAPL   2018-10-03  232.\n2 AMZN   2018-09-04 2040.\n3 FB     2018-07-25  218.\n4 GOOG   2018-07-26 1268.\n```\n\n\n:::\n:::\n\n\n\n## Exercise 3\n\nDownload the file `tute1.csv` from the [book website](https://bit.ly/fpptute1), open it in Excel (or some other spreadsheet application), and review its contents. You should find four columns of information. Columns B through D each contain a quarterly series, labelled Sales, AdBudget and GDP. Sales contains the quarterly sales for a small company over the period 1981-2005. AdBudget is the advertising budget and GDP is the gross domestic product. All series have been adjusted for inflation.\n\n    (a) Read the data and create time series\n    (b) Construct ts plot for each series\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntute1 <- readr::read_csv(here::here(\"data/tute1.csv\"))\nhead(tute1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n  Quarter    Sales AdBudget   GDP\n  <date>     <dbl>    <dbl> <dbl>\n1 1981-03-01 1020.     659.  252.\n2 1981-06-01  889.     589   291.\n3 1981-09-01  795      512.  291.\n4 1981-12-01 1004.     614.  292.\n5 1982-03-01 1058.     647.  279.\n6 1982-06-01  944.     602   254 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntute1 %>% \n  mutate(Quarter = yearquarter(Quarter)) %>% \n  as_tsibble(index = Quarter) -> ts_tute\n\nts_tute\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 100 x 4 [1Q]\n   Quarter Sales AdBudget   GDP\n     <qtr> <dbl>    <dbl> <dbl>\n 1 1981 Q1 1020.     659.  252.\n 2 1981 Q2  889.     589   291.\n 3 1981 Q3  795      512.  291.\n 4 1981 Q4 1004.     614.  292.\n 5 1982 Q1 1058.     647.  279.\n 6 1982 Q2  944.     602   254 \n 7 1982 Q3  778.     531.  296.\n 8 1982 Q4  932.     608.  272.\n 9 1983 Q1  996.     638.  260.\n10 1983 Q2  908.     582.  280.\n# ℹ 90 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_tute %>% \n  pivot_longer(-Quarter) %>% autoplot(value)\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_tute %>% \n  pivot_longer(-Quarter) %>% \n  ggplot(aes(x = Quarter, y = value, color = name)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_tute %>% \n  pivot_longer(-Quarter) %>% \n  ggplot(aes(x = Quarter, y = value, color = name)) +\n  geom_line() +\n  facet_grid(name ~ ., scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Exercise 4\n\nThe `USgas` package contains data on the demand for natural gas in the US.\n\n(a) Create a tsibble from us_total with year as the index and state as the key.\n(b) Plot the annual natural gas consumption by state for the New England area (comprising the states of Maine, Vermont, New Hampshire, Massachusetts, Connecticut and Rhode Island).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(us_total, package = \"USgas\")\n\nhead(us_total)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  year   state      y\n1 1997 Alabama 324158\n2 1998 Alabama 329134\n3 1999 Alabama 337270\n4 2000 Alabama 353614\n5 2001 Alabama 332693\n6 2002 Alabama 379343\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nus_total %>% \n  as_tsibble(index = year, key = state) -> ts_us_total\n\nts_us_total\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 1,266 x 3 [1Y]\n# Key:       state [53]\n    year state        y\n   <int> <chr>    <int>\n 1  1997 Alabama 324158\n 2  1998 Alabama 329134\n 3  1999 Alabama 337270\n 4  2000 Alabama 353614\n 5  2001 Alabama 332693\n 6  2002 Alabama 379343\n 7  2003 Alabama 350345\n 8  2004 Alabama 382367\n 9  2005 Alabama 353156\n10  2006 Alabama 391093\n# ℹ 1,256 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_us_total %>% \n  filter(state %in% c(\"Maine\", \"Vermont\", \"New Hampshire\", \"Massachusetts\", \"Connecticut\",\n                      \"Rhode Island\")) %>% \n  autoplot(y) +\n  scale_y_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale()))\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Exercise 5\n\n(a) Download `tourism.xlsx` from the [book website](https://bit.ly/fpptourism) and read it into R using `readxl::read_excel()`.\n(b) Create a `tsibble` which is identical to the tourism tsibble from the tsibble package.\n(c) Find what combination of Region and Purpose had the maximum number of overnight trips on average.\n(d) Create a new `tsibble` which combines the Purposes and Regions, and just has total trips by State.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism_xl <- readxl::read_excel(\"data/tourism.xlsx\")\nhead(tourism_xl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  Quarter    Region   State           Purpose  Trips\n  <chr>      <chr>    <chr>           <chr>    <dbl>\n1 1998-01-01 Adelaide South Australia Business  135.\n2 1998-04-01 Adelaide South Australia Business  110.\n3 1998-07-01 Adelaide South Australia Business  166.\n4 1998-10-01 Adelaide South Australia Business  127.\n5 1999-01-01 Adelaide South Australia Business  137.\n6 1999-04-01 Adelaide South Australia Business  200.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 24,320 x 5 [1Q]\n# Key:       Region, State, Purpose [304]\n   Quarter Region   State           Purpose  Trips\n     <qtr> <chr>    <chr>           <chr>    <dbl>\n 1 1998 Q1 Adelaide South Australia Business  135.\n 2 1998 Q2 Adelaide South Australia Business  110.\n 3 1998 Q3 Adelaide South Australia Business  166.\n 4 1998 Q4 Adelaide South Australia Business  127.\n 5 1999 Q1 Adelaide South Australia Business  137.\n 6 1999 Q2 Adelaide South Australia Business  200.\n 7 1999 Q3 Adelaide South Australia Business  169.\n 8 1999 Q4 Adelaide South Australia Business  134.\n 9 2000 Q1 Adelaide South Australia Business  154.\n10 2000 Q2 Adelaide South Australia Business  169.\n# ℹ 24,310 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism_xl %>% \n  mutate(Quarter = yearquarter(Quarter)) %>% \n  as_tsibble(index = Quarter, key = c(Region, State, Purpose)) -> tourism_ts\n\ntourism_ts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 24,320 x 5 [1Q]\n# Key:       Region, State, Purpose [304]\n   Quarter Region   State           Purpose  Trips\n     <qtr> <chr>    <chr>           <chr>    <dbl>\n 1 1998 Q1 Adelaide South Australia Business  135.\n 2 1998 Q2 Adelaide South Australia Business  110.\n 3 1998 Q3 Adelaide South Australia Business  166.\n 4 1998 Q4 Adelaide South Australia Business  127.\n 5 1999 Q1 Adelaide South Australia Business  137.\n 6 1999 Q2 Adelaide South Australia Business  200.\n 7 1999 Q3 Adelaide South Australia Business  169.\n 8 1999 Q4 Adelaide South Australia Business  134.\n 9 2000 Q1 Adelaide South Australia Business  154.\n10 2000 Q2 Adelaide South Australia Business  169.\n# ℹ 24,310 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism_ts %>% \n  group_by(Region, Purpose) %>% \n  summarise(trips = sum(Trips), .groups = \"drop\") %>%\n  slice_max(trips, n = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 1 x 4 [1Q]\n# Key:       Region, Purpose [1]\n  Region    Purpose  Quarter trips\n  <chr>     <chr>      <qtr> <dbl>\n1 Melbourne Visiting 2017 Q4  985.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism_ts %>% \n  group_by(State) %>% \n  summarise(trips = sum(Trips), .groups = \"drop\") -> trips_by_state\n\ntrips_by_state\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 640 x 3 [1Q]\n# Key:       State [8]\n   State Quarter trips\n   <chr>   <qtr> <dbl>\n 1 ACT   1998 Q1  551.\n 2 ACT   1998 Q2  416.\n 3 ACT   1998 Q3  436.\n 4 ACT   1998 Q4  450.\n 5 ACT   1999 Q1  379.\n 6 ACT   1999 Q2  558.\n 7 ACT   1999 Q3  449.\n 8 ACT   1999 Q4  595.\n 9 ACT   2000 Q1  600.\n10 ACT   2000 Q2  557.\n# ℹ 630 more rows\n```\n\n\n:::\n:::\n\n\n\n## Exercise 6\n\nThe `aus_arrivals` data set comprises quarterly international arrivals to Australia from Japan, New Zealand, UK and the US.\n\n(a) Use `autoplot()`, `gg_season()` and `gg_subseries()` to compare the differences between the arrivals from these four countries.\n(b) Can you identify any unusual observations?\n\n\n::: {.cell}\n\n```{.r .cell-code}\naus_arrivals\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 508 x 3 [1Q]\n# Key:       Origin [4]\n   Quarter Origin Arrivals\n     <qtr> <chr>     <int>\n 1 1981 Q1 Japan     14763\n 2 1981 Q2 Japan      9321\n 3 1981 Q3 Japan     10166\n 4 1981 Q4 Japan     19509\n 5 1982 Q1 Japan     17117\n 6 1982 Q2 Japan     10617\n 7 1982 Q3 Japan     11737\n 8 1982 Q4 Japan     20961\n 9 1983 Q1 Japan     20671\n10 1983 Q2 Japan     12235\n# ℹ 498 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naus_arrivals %>% \n  autoplot(Arrivals) +\n  scale_y_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale()))\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naus_arrivals %>% \n  gg_season(Arrivals) +\n  scale_y_continuous(labels = scales::label_number(scale_cut = scales::cut_short_scale()))\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naus_arrivals %>% gg_subseries(Arrivals)\n```\n\n::: {.cell-output-display}\n![](ch2_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ch2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}